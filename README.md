# BarcodesFilter
 Filter barcodes based on some criteria



---
### :warning: Requirements:
- Generate Barcodes:
    To Generate barcodes via BarcodesFilter you have to:
    - <img src="https://github.com/devicons/devicon/blob/master/icons/linux/linux-original.svg" title="Linux" alt="Linux" width="20" height="20"/>&nbsp; <img src="https://github.com/devicons/devicon/blob/master/icons/bash/bash-original.svg" title="Bash" alt="Bash" width="20" height="20"/>&nbsp; Use a machine with a **linux** distribution that uses **bash** as shell
    - Install **rsat** package via conda environment: you can check the installation tutorial [here](https://rsa-tools.github.io/installing-RSAT/conda-install-rsat/bioconda-rsat-core.html "RSAT Installation Tutorial")  
        </br>
        OBS: Errors can occur because of conflits with the python version. You can fix that by installing rsat via **mamba** instead of conda, like this:  
        </br>
        &nbsp; Install mamba
        ```shell
        conda install -n base conda-forge::mamba
        ```
        &nbsp; Create 'rsat' conda environment with python 3.7
        ```shell
        mamba create -n rsat python=3.7
        ```
        &nbsp; Activate environment
        ```shell
        conda activate rsat
        ```
        &nbsp; Install rsat
        ```shell
        mamba install -c bioconda rsat-core
        ```

- General:
    - <img src="https://github.com/devicons/devicon/blob/master/icons/python/python-original.svg" title="Python" alt="Python" width="20" height="20"/>&nbsp; Python 3.7
    - <img src="https://github.com/devicons/devicon/blob/master/icons/python/python-original.svg" title="Python" alt="Python" width="20" height="20"/>&nbsp; Python Libraries/Modules:
        - YAML
        - Biopython
        - Difflib

---
### :broom: Barcodes Filter Criteria

- Filter by **Baseruns**:

> Discard sequences with baseruns (base repetition) bigger than the max number defined by the user  
> &nbsp; &nbsp; Example:  
> &nbsp; &nbsp; &nbsp; Max baserun = 2  
> &nbsp; &nbsp; &nbsp; Sequence: ACAATG -> will not be discarded  
> &nbsp; &nbsp; &nbsp; Sequence: ACAAATG -> will be discarded because of 'AAA'  

- Filter by **Common Subsequence** between barcodes:

> Discard barcodes that contain same subsequence, at the same position, (with min size defined by the user) as an already selected barcode  
> &nbsp; &nbsp;Example:  
> &nbsp; &nbsp; &nbsp; **Max similarity between sequences** = 3  
> &nbsp; &nbsp; &nbsp; **Barcode1:** ACAATG -> **Selected**  
> &nbsp; &nbsp; &nbsp; **Barcode2:** ACAACC -> **Discarded** because has the same subsequence as Barcode1, at the same position  
> &nbsp; &nbsp; &nbsp; **Barcode3:** CACAAT -> **Selected** because has the same subsequence as Barcode1, but at a different position  
> &nbsp; &nbsp; &nbsp; **Barcode4:** ACATCC -> **Selected** because the common subsequence did not surpass the max similarity


---
### :memo: Tutorial

- User configuration is defined via the **config.yaml** file, like this:
```YAML
APP:
  OS: linux
  SHELL: bash
  GENERATE_BARCODES: True # If the barcodes should be generated by the program

VARIABLES:
  INPUT_FILE: input/fasta_barcodes_input.fa
  OUTPUT_FILE: output/fasta_barcodes_output.fa
  # Max tolerance for common nucleotides in subsequences between two sequences (the subsequences must be at the same position)
  # If the common subsequence has more nucleotides than the tolerance value, the second sequence will be discarded
  MAX_SIMILARITY: 5 
  MAX_BASERUN_REPETITION: 2

# Configuration for barcodes generation
GENERATE_BARCODES:
  CONDA_SOURCE: /home/bioinfo/miniconda3/etc/profile.d/conda.sh
  LENGTH: 12
  NUMBER: 50
  FILE_NAME: input/fasta_barcodes_input.fa


```
- The barcodes **input** file can be a **TXT** or a **FASTA**.
    - TXT:
    ```txt
    AGCATCTACAGCC
    TGCATGACCCCCC
    GTCAGGAGGCTAA
    GCAAAACATCTCT
    TGCAACCGGGGAG
    ```
    - FASTA:
    ```fasta
    >rand_1 random sequence 1/50; type: dna; length: 12
    TGGGCTCCTCCG
    >rand_2 random sequence 2/50; type: dna; length: 12
    AACGGACAATTT
    >rand_3 random sequence 3/50; type: dna; length: 12
    GTACGGGGCGCC
    >rand_4 random sequence 4/50; type: dna; length: 12
    TATTGGCTACAG
    >rand_5 random sequence 5/50; type: dna; length: 12
    AAGAGGAACTAA
    ```
-You can also save the **output** results with a **TXT** or a **FASTA** extension by specifying it via the output file variable in the config.yaml file
---